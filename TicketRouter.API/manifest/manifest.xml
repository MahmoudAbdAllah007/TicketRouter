<?xml version="1.0" encoding="utf-8" ?>
<OfficeApp
    xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
	xsi:type="MailApp">

<!-- Basic identification -->	
	<Id>D93E714C-3281-4F5B-B99F-2D8D88422A48</Id>
	<Version>1.0.0.0</Version>
	<ProviderName>Mahmoud Abd-Allah</ProviderName>
	<DefaultLocale>en-US</DefaultLocale>
	<DisplayName DefaultValue="Ticket Router"/>
	<Description DefaultValue="Automatically create and route Outlook emails into case folders by ticket number."/>

<!-- URLs -->
	<IconUrl DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/assets/icon-32.png"/>
	<HighResolutionIconUrl DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/assets/icon-80.png"/>
	<SupportUrl DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/support.html"/>

<!-- Domain whitelist -->
	<AppDomains>
		<AppDomain>https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net</AppDomain>
		<AppDomain>https://mahlab.net</AppDomain>
	</AppDomains>
	
<!-- This defines it as an Outlook add-in -->
	<Hosts>
		<Host Name="Mailbox" />
	</Hosts>
	
<!-- Requirements -->
	<Requirements>
		<Sets>
			<Set Name="Mailbox" MinVersion="1.1"/>
		</Sets>
	</Requirements>
	<FormSettings>
		<Form xsi:type="ItemRead">
			<DesktopSettings>
				<SourceLocation DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/taskpane.html"/>
				<RequestedHeight>250</RequestedHeight>
			</DesktopSettings>
		</Form>
	</FormSettings>

<!-- Permissions -->
	<Permissions>ReadWriteItem</Permissions>
	
<!-- Default rule (always show add-in) -->
	<Rule xsi:type="RuleCollection" Mode="Or">
		<Rule xsi:type="ItemIs" ItemType="Message" FormType="Read" />
		<Rule xsi:type="ItemIs" ItemType="Message" FormType="Edit" />
	</Rule>
	<DisableEntityHighlighting>false</DisableEntityHighlighting>

<!-- VersionOverrides defines UI and commands -->
	<VersionOverrides xmlns="http://schemas.microsoft.com/office/mailappversionoverrides" xsi:type="VersionOverridesV1_0">
		<VersionOverrides xmlns="http://schemas.microsoft.com/office/mailappversionoverrides/1.1" xsi:type="VersionOverridesV1_1">
			<Requirements>
				<bt:Sets DefaultMinVersion="1.3">
					<bt:Set Name="Mailbox" />
				</bt:Sets>
			</Requirements>
			<Hosts>
				<Host xsi:type="MailHost">
					<DesktopFormFactor>
						<ExtensionPoint xsi:type="MessageReadCommandSurface">
							<OfficeTab id="TabDefault">
								<Group id="msgWriteGroup">
									<Label resid="TicketTools"/>
									<Control xsi:type="Button" id="btn.OpenPane">
										<Label resid="residOpenPaneLabel" />
										<Supertip>
											<Title resid="residOpenPaneLabel" />
											<Description resid="residOpenPaneDesc" />
										</Supertip>
										<Icon>
											<bt:Image size="16" resid="icon16" />
											<bt:Image size="32" resid="icon32" />
											<bt:Image size="80" resid="icon80" />
										</Icon>
										<Action xsi:type="ShowTaskpane">
											<SourceLocation resid="TaskPane.Page.Url" />
										</Action>
									</Control>
								</Group>
							</OfficeTab>
						</ExtensionPoint>
					</DesktopFormFactor>
				</Host>
			</Hosts>
		
<!-- Localized strings and resources -->
			<Resources>
				<bt:Images>
					<bt:Image id="icon16" DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/assets/icon-16.png"/>
					<bt:Image id="icon32" DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/assets/icon-32.png"/>
					<bt:Image id="icon80" DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/assets/icon-80.png"/>
				</bt:Images>
				<bt:Urls>
					<bt:Url id="TaskPane.Page.Url" DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/taskpane.html"/>
					<bt:Url id="TaskPane.Script.Url" DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/taskpane.js"/>
				</bt:Urls>
				<bt:ShortStrings>
					<bt:String id="TicketTools" DefaultValue="TicketTools"/>
					<bt:String id="residOpenPaneLabel" DefaultValue="Open Ticket Router" />
				</bt:ShortStrings>
				<bt:LongStrings>
					<bt:String id="residOpenPaneDesc" DefaultValue="Open task pane to detect TrackingID and route message."/>
				</bt:LongStrings>
			</Resources>
			<WebApplicationInfo>
				<Id>4d09ec78-265b-432f-b9dc-cda9a0bb2477</Id>
				<Resource>api://4d09ec78-265b-432f-b9dc-cda9a0bb2477</Resource>
				<Scopes>
					<Scope>access_as_user</Scope>
					<Scope>Mail.ReadWrite</Scope>
					<Scope>MailboxSettings.Read</Scope>
					<Scope>openid</Scope>
					<Scope>profile</Scope>
				</Scopes>
			</WebApplicationInfo>
		</VersionOverrides>
	</VersionOverrides>
</OfficeApp>

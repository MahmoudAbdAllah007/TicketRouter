<?xml version="1.0" encoding="UTF-8"?>
<OfficeApp
  xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
  xmlns:mailappor="http://schemas.microsoft.com/office/mailappversionoverrides/1.0"
  xsi:type="MailApp">

	<!-- Your existing IDs -->
	<Id>D93E714C-3281-4F5B-B99F-2D8D88422A48</Id>
	<Version>1.0.0.0</Version>
	<ProviderName>Ticket Routing Add-in</ProviderName>
	<DefaultLocale>en-US</DefaultLocale>
	<DisplayName DefaultValue="Ticket Router"/>
	<Description DefaultValue="Route emails by TrackingID# pattern into ticket folders"/>

	<!-- Icons (must be reachable HTTPS) -->
	<IconUrl DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/assets/icon-32.png"/>
	<HighResolutionIconUrl DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/assets/icon-64.png"/>

	<!-- Required by validator -->
	<SupportUrl DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/support"/>

	<!-- AppDomains must be secured, non-localhost, and valid -->
	<AppDomains>
		<AppDomain>https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net</AppDomain>
	</AppDomains>

	<Hosts>
		<Host Name="Mailbox"/>
	</Hosts>

	<Requirements>
		<Sets DefaultMinVersion="1.13">
			<Set Name="Mailbox" MinVersion="1.13"/>
		</Sets>
	</Requirements>

	<FormSettings>
		<Form xsi:type="ItemRead">
			<DesktopSettings>
				<SourceLocation DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/taskpane.html"/>
				<RequestedHeight>350</RequestedHeight>
			</DesktopSettings>
		</Form>
	</FormSettings>

	<Permissions>ReadWriteMailbox</Permissions>

	<!-- IMPORTANT: Rule must come AFTER Permissions -->
	<Rule xsi:type="RuleCollection" Mode="Or">
		<Rule xsi:type="ItemIs" ItemType="Message" FormType="Read"/>
	</Rule>

	<!-- VersionOverrides v1.1 (Ribbon + Task Pane only in this minimal version) -->
	<mailappor:VersionOverrides xsi:type="VersionOverridesV1_1">
		<Hosts>
			<Host xsi:type="MailHost">
				<Runtimes>
					<Runtime resid="TaskPane.Script.Url" lifetime="long"/>
				</Runtimes>

				<DesktopFormFactor>
					<ExtensionPoint xsi:type="MessageReadCommandSurface">
						<OfficeTab id="TabDefault">
							<Group id="grp.Ticket" label="Ticket Tools" icon="residRibbonIcon">
								<Control xsi:type="Button" id="btn.OpenPane">
									<Label resid="residOpenPaneLabel"/>
									<Supertip>
										<Title resid="residOpenPaneLabel"/>
										<Description resid="residOpenPaneDesc"/>
									</Supertip>
									<Icon>
										<bt:Image size="16" resid="residRibbonIcon"/>
										<bt:Image size="32" resid="residRibbonIcon"/>
										<bt:Image size="80" resid="residRibbonIcon"/>
									</Icon>
									<Action xsi:type="ShowTaskpane">
										<SourceLocation resid="TaskPane.Page.Url"/>
									</Action>
								</Control>
							</Group>
						</OfficeTab>
					</ExtensionPoint>
				</DesktopFormFactor>
			</Host>
		</Hosts>

		<Resources>
			<bt:Urls>
				<bt:Url id="TaskPane.Page.Url"  DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/taskpane.html"/>
				<bt:Url id="TaskPane.Script.Url" DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/taskpane.js"/>
			</bt:Urls>

			<bt:ShortStrings>
				<bt:String id="residOpenPaneLabel" DefaultValue="Route to Ticket"/>
			</bt:ShortStrings>
			<bt:LongStrings>
				<bt:String id="residOpenPaneDesc" DefaultValue="Open task pane to detect TrackingID and route message."/>
			</bt:LongStrings>

			<bt:Images>
				<bt:Image id="residRibbonIcon" DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/assets/icon-32.png"/>
			</bt:Images>
		</Resources>
	</mailappor:VersionOverrides>
<?xml version="1.0" encoding="UTF-8"?>
<OfficeApp
  xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
  xmlns:mailappor="http://schemas.microsoft.com/office/mailappversionoverrides/1.0"
  xsi:type="MailApp">

  <!-- Your existing IDs -->
  <Id>D93E714C-3281-4F5B-B99F-2D8D88422A48</Id>
  <Version>1.0.0.0</Version>
  <ProviderName>Ticket Routing Add-in</ProviderName>
  <DefaultLocale>en-US</DefaultLocale>
  <DisplayName DefaultValue="Ticket Router"/>
  <Description DefaultValue="Route emails by TrackingID# pattern into ticket folders"/>

  <!-- Icons (must be reachable HTTPS) -->
  <IconUrl DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/assets/icon-32.png"/>
  <HighResolutionIconUrl DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/assets/icon-64.png"/>

  <!-- Required by validator -->
  <SupportUrl DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/support"/>

  <!-- AppDomains must be secured, non-localhost, and valid -->
  <AppDomains>
    <AppDomain>https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net</AppDomain>
  </AppDomains>

  <Hosts>
    <Host Name="Mailbox"/>
  </Hosts>

  <Requirements>
    <Sets DefaultMinVersion="1.13">
      <Set Name="Mailbox" MinVersion="1.13"/>
    </Sets>
  </Requirements>

  <FormSettings>
    <Form xsi:type="ItemRead">
      <DesktopSettings>
        <SourceLocation DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/taskpane.html"/>
        <RequestedHeight>350</RequestedHeight>
      </DesktopSettings>
    </Form>
  </FormSettings>

  <Permissions>ReadWriteMailbox</Permissions>

  <!-- IMPORTANT: Rule must come AFTER Permissions -->
  <Rule xsi:type="RuleCollection" Mode="Or">
    <Rule xsi:type="ItemIs" ItemType="Message" FormType="Read"/>
  </Rule>

  <!-- VersionOverrides v1.1 (Ribbon + Task Pane only in this minimal version) -->
  <mailappor:VersionOverrides xsi:type="VersionOverridesV1_1">
    <Hosts>
      <Host xsi:type="MailHost">
        <Runtimes>
          <Runtime resid="TaskPane.Script.Url" lifetime="long"/>
        </Runtimes>

        <DesktopFormFactor>
          <ExtensionPoint xsi:type="MessageReadCommandSurface">
            <OfficeTab id="TabDefault">
              <Group id="grp.Ticket" label="Ticket Tools" icon="residRibbonIcon">
                <Control xsi:type="Button" id="btn.OpenPane">
                  <Label resid="residOpenPaneLabel"/>
                  <Supertip>
                    <Title resid="residOpenPaneLabel"/>
                    <Description resid="residOpenPaneDesc"/>
                  </Supertip>
                  <Icon>
                    <bt:Image size="16" resid="residRibbonIcon"/>
                    <bt:Image size="32" resid="residRibbonIcon"/>
                    <bt:Image size="80" resid="residRibbonIcon"/>
                  </Icon>
                  <Action xsi:type="ShowTaskpane">
                    <SourceLocation resid="TaskPane.Page.Url"/>
                  </Action>
                </Control>
              </Group>
            </OfficeTab>
          </ExtensionPoint>
        </DesktopFormFactor>
      </Host>
    </Hosts>

    <Resources>
      <bt:Urls>
        <bt:Url id="TaskPane.Page.Url"  DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/taskpane.html"/>
        <bt:Url id="TaskPane.Script.Url" DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/taskpane.js"/>
      </bt:Urls>

      <bt:ShortStrings>
        <bt:String id="residOpenPaneLabel" DefaultValue="Route to Ticket"/>
      </bt:ShortStrings>
      <bt:LongStrings>
        <bt:String id="residOpenPaneDesc" DefaultValue="Open task pane to detect TrackingID and route message."/>
      </bt:LongStrings>

      <bt:Images>
        <bt:Image id="residRibbonIcon" DefaultValue="https://ticketrouterapi-ecd7h3b6a6cme3g8.canadacentral-01.azurewebsites.net/client/assets/icon-32.png"/>
      </bt:Images>
    </Resources>
  </mailappor:VersionOverrides>
</OfficeApp>
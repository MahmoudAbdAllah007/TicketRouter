<?xml version="1.0" encoding="utf-8" ?>

<OfficeApp
          xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
          xmlns:mailappor="http://schemas.microsoft.com/office/mailappversionoverrides/1.0"
          xsi:type="MailApp">

	<!-- Basic metadata -->
	<Id>c9e2f38f-3d4b-4a3d-9b3f-123456789abc</Id>
	<Version>1.0.0.0</Version>
	<ProviderName>Ticket Router Dev</ProviderName>
	<DefaultLocale>en-US</DefaultLocale>
	<DisplayName DefaultValue="Ticket Router (Dev)" />
	<Description DefaultValue="Route emails into folders based on ticket number. Development sideload." />
	<IconUrl DefaultValue="https://localhost:3000/assets/client/icon-32.png" />
	<HighResolutionIconUrl DefaultValue="https://localhost:3000/client/assets/icon-64.png" />
	<SupportUrl DefaultValue="https://localhost:3000/client/support.html" />
	<AppDomains>
		<AppDomain>https://localhost:3000</AppDomain>
	</AppDomains>
	<Hosts>
		<Host Name="Mailbox"/>
	</Hosts>
	<Requirements>
		<Sets>
			<Set Name="Mailbox" MinVersion="1.1" />
		</Sets>
	</Requirements>
	<FormSettings>
		<Form xsi:type="ItemRead">
			<DesktopSettings>
				<SourceLocation DefaultValue="https://localhost:3000/client/taskpane.html"/>
				<RequestedHeight>350</RequestedHeight>
			</DesktopSettings>
		</Form>
	</FormSettings>
	<!-- Permissions -->
	<Permissions>ReadWriteMailbox</Permissions>

	<!-- Default rule (always show add-in) -->
	<Rule xsi:type="RuleCollection" Mode="Or">
		<Rule xsi:type="ItemIs" ItemType="Message" FormType="Read"/>
		<Rule xsi:type="ItemIs" ItemType="Message" FormType="Edit"/>
	</Rule>
	<DisableEntityHighlighting>false</DisableEntityHighlighting>

	<!-- VersionOverrides defines UI and commands -->
	<VersionOverrides xmlns="http://schemas.microsoft.com/office/mailappversionoverrides" xsi:type="VersionOverridesV1_0">
		<VersionOverrides xmlns="http://schemas.microsoft.com/office/mailappversionoverrides/1.1" xsi:type="VersionOverridesV1_1">
			<Requirements>
				<bt:Sets DefaultMinVersion="1.3">
					<bt:Set Name="Mailbox" />
				</bt:Sets>
			</Requirements>
			<Hosts>
			<Host xsi:type="MailHost">
				<DesktopFormFactor>
					<FunctionFile resid="functionFile" />
					<ExtensionPoint xsi:type="MessageReadCommandSurface">
						<OfficeTab id="TabDefault">
							<Group id="grp.Ticket">
								<Label resid="Ticket Tools"/>
								<Control xsi:type="Button" id="btn.OpenPane">
									<Label resid="residOpenPaneLabel"/>
									<Supertip>
										<Title resid="residOpenPaneLabel"/>
										<Description resid="residOpenPaneDesc"/>
									</Supertip>
									<Icon>
										<bt:Image size="32" resid="icon32"/>
										<bt:Image size="80" resid="icon80"/>
									</Icon>
									<Action xsi:type="ShowTaskpane">
										<SourceLocation resid="TaskPane.Page.Url"/>
									</Action>
								</Control>
							</Group>
						</OfficeTab>
					</ExtensionPoint>

					<ExtensionPoint xsi:type="MessageComposeCommandSurface">
						<OfficeTab id="TabDefault">
							<Group id="grp.Ticket">
								<Label resid="Ticket Tools"/>
								<Control xsi:type="Button" id="btn.OpenPane">
									<Label resid="residOpenPaneLabel"/>
									<Supertip>
										<Title resid="residOpenPaneLabel"/>
										<Description resid="residOpenPaneDesc"/>
									</Supertip>
									<Icon>
										<bt:Image size="32" resid="icon32"/>
										<bt:Image size="80" resid="icon80"/>
									</Icon>
									<Action xsi:type="ShowTaskpane">
										<SourceLocation resid="TaskPane.Page.Url"/>
									</Action>
								</Control>
							</Group>
						</OfficeTab>
					</ExtensionPoint>
				</DesktopFormFactor>
			</Host>
		</Hosts>

		<Resources>
			<bt:Images>
				<bt:Image id="icon32" DefaultValue="https://localhost:3000/client/assets/icon-32.png"/>
				<bt:Image id="icon80" DefaultValue="https://localhost:3000/client/assets/icon-80.png"/>
			</bt:Images>
			<bt:Urls>
				<bt:Url id="TaskPane.Page.Url" DefaultValue="https://localhost:3000/client/taskpane.html"/>
				<bt:Url id="TaskPane.Script.Url" DefaultValue="https://localhost:3000/client/taskpane.js"/>
			</bt:Urls>
			<bt:ShortStrings>
				<bt:String id="residOpenPaneLabel" DefaultValue="Route to Ticket"/>
			</bt:ShortStrings>
			<bt:LongStrings>
				<bt:String id="residOpenPaneDesc" DefaultValue="Open task pane to detect TrackingID and route message."/>
			</bt:LongStrings>
		</Resources>
		</VersionOverrides>
	</VersionOverrides>
</OfficeApp>
